hist(rnorm(100))
hist(rnorm(100))
hist(rnorm(100))
hist(rnorm(100))
hist(rnorm(100))
hist(rnorm(100))
hist(rnorm(100))
hist(rnorm(100))
hist(rnorm(100))
hist(rnorm(100))
hist(rnorm(100))
hist(rnorm(100))
hist(rnorm(100))
hist(rnorm(100))
hist(rnorm(100))
hist(rnorm(100))
hist(rnorm(100))
hist(rnorm(100))
l<-rbinom(1000,1,0.5)
x<-vector(length=1000)
for (i in 1:1000){
if(l[i]==0){
x[i]=rnorm(1,mean=1,sd=1)
}
else{x[i]=rnorm(1,mean=2,sd=2)}
}
hist(x)
l<-rbinom(1000,1,0.5)
x<-vector(length=1000)
for (i in 1:1000){
if(l[i]==0){
x[i]=rnorm(1,mean=1,sd=1)
}
else{x[i]=rnorm(1,mean=2,sd=2)}
}
hist(x)
l<-rbinom(1000,1,0.5)
x<-vector(length=1000)
for (i in 1:1000){
if(l[i]==0){
x[i]=rnorm(1,mean=1,sd=1)
}
else{x[i]=rnorm(1,mean=2,sd=2)}
}
hist(x)
l<-rbinom(1000,1,0.5)
x<-vector(length=1000)
for (i in 1:1000){
if(l[i]==0){
x[i]=rnorm(1,mean=1,sd=1)
}
else{x[i]=rnorm(1,mean=2,sd=2)}
}
hist(x)
l<-rbinom(1000,1,0.5)
x<-vector(length=1000)
for (i in 1:1000){
if(l[i]==0){
x[i]=rnorm(1,mean=1,sd=1)
}
else{x[i]=rnorm(1,mean=2,sd=2)}
}
hist(x)
l<-rbinom(1000,1,0.5)
x<-vector(length=1000)
for (i in 1:1000){
if(l[i]==0){
x[i]=rnorm(1,mean=1,sd=1)
}
else{x[i]=rnorm(1,mean=2,sd=2)}
}
hist(x)
l<-rbinom(1000,1,0.5)
x<-vector(length=1000)
for (i in 1:1000){
if(l[i]==0){
x[i]=rnorm(1,mean=1,sd=1)
}
else{x[i]=rnorm(1,mean=2,sd=2)}
}
hist(x)
l<-rbinom(1000,1,0.5)
x<-vector(length=1000)
for (i in 1:1000){
if(l[i]==0){
x[i]=rnorm(1,mean=1,sd=1)
}
else{x[i]=rnorm(1,mean=2,sd=2)}
}
hist(x)
l<-rbinom(1000,1,0.5)
x<-vector(length=1000)
for (i in 1:1000){
if(l[i]==0){
x[i]=rnorm(1,mean=1,sd=1)
}
else{x[i]=rnorm(1,mean=2,sd=2)}
}
hist(x)
l<-rbinom(1000,1,0.5)
x<-vector(length=1000)
for (i in 1:1000){
if(l[i]==0){
x[i]=rnorm(1,mean=1,sd=1)
}
else{x[i]=rnorm(1,mean=2,sd=2)}
}
hist(x)
l<-rbinom(1000,1,0.5)
x<-vector(length=1000)
for (i in 1:1000){
if(l[i]==0){
x[i]=rnorm(1,mean=1,sd=1)
}
else{x[i]=rnorm(1,mean=2,sd=2)}
}
hist(x)
l<-rbinom(1000,1,0.5)
x<-vector(length=1000)
for (i in 1:1000){
if(l[i]==0){
x[i]=rnorm(1,mean=1,sd=1)
}
else{x[i]=rnorm(1,mean=2,sd=2)}
}
hist(x)
l<-rbinom(1000,1,0.5)
x<-vector(length=1000)
for (i in 1:1000){
if(l[i]==0){
x[i]=rnorm(1,mean=1,sd=1)
}
else{x[i]=rnorm(1,mean=2,sd=2)}
}
hist(x)
l<-rbinom(1000,1,0.5)
x<-vector(length=1000)
for (i in 1:1000){
if(l[i]==0){
x[i]=rnorm(1,mean=1,sd=1)
}
else{x[i]=rnorm(1,mean=2,sd=2)}
}
hist(x)
l<-rbinom(1000,1,0.5)
x<-vector(length=1000)
for (i in 1:1000){
if(l[i]==0){
x[i]=rnorm(1,mean=1,sd=1)
}
else{x[i]=rnorm(1,mean=2,sd=2)}
}
hist(x)
l<-rbinom(1000,1,0.5)
x<-vector(length=1000)
for (i in 1:1000){
if(l[i]==0){
x[i]=rnorm(1,mean=1,sd=1)
}
else{x[i]=rnorm(1,mean=2,sd=2)}
}
hist(x)
l<-rbinom(1000,1,0.5)
x<-vector(length=1000)
for (i in 1:1000){
if(l[i]==0){
x[i]=rnorm(1,mean=1,sd=1)
}
else{x[i]=rnorm(1,mean=2,sd=2)}
}
hist(x)
l<-rbinom(1000,1,0.5)
x<-vector(length=1000)
for (i in 1:1000){
if(l[i]==0){
x[i]=rnorm(1,mean=1,sd=1)
}
else{x[i]=rnorm(1,mean=2,sd=2)}
}
hist(x)
l<-rbinom(1000,1,0.5)
x<-vector(length=1000)
for (i in 1:1000){
if(l[i]==0){
x[i]=rnorm(1,mean=1,sd=1)
}
else{x[i]=rnorm(1,mean=2,sd=2)}
}
hist(x)
l<-rbinom(1000,1,0.5)
x<-vector(length=1000)
for (i in 1:1000){
if(l[i]==0){
x[i]=rnorm(1,mean=1,sd=1)
}
else{x[i]=rnorm(1,mean=2,sd=2)}
}
hist(x)
l<-rbinom(1000,1,0.5)
x<-vector(length=1000)
for (i in 1:1000){
if(l[i]==0){
x[i]=rnorm(1,mean=1,sd=1)
}
else{x[i]=rnorm(1,mean=2,sd=2)}
}
hist(x)
l<-rbinom(1000,1,0.5)
x<-vector(length=1000)
for (i in 1:1000){
if(l[i]==0){
x[i]=rnorm(1,mean=1,sd=1)
}
else{x[i]=rnorm(1,mean=2,sd=2)}
}
hist(x)
l<-rbinom(1000,1,0.5)
x<-vector(length=1000)
for (i in 1:1000){
if(l[i]==0){
x[i]=rnorm(1,mean=1,sd=1)
}
else{x[i]=rnorm(1,mean=2,sd=2)}
}
hist(x)
l<-rbinom(1000,1,0.5)
x<-vector(length=1000)
for (i in 1:1000){
if(l[i]==0){
x[i]=rnorm(1,mean=1,sd=1)
}
else{x[i]=rnorm(1,mean=2,sd=2)}
}
hist(x)
l<-rbinom(1000,1,0.5)
x<-vector(length=1000)
for (i in 1:1000){
if(l[i]==0){
x[i]=rnorm(1,mean=1,sd=1)
}
else{x[i]=rnorm(1,mean=2,sd=2)}
}
hist(x)
l<-rbinom(1000,1,0.5)
x<-vector(length=1000)
for (i in 1:1000){
if(l[i]==0){
x[i]=rnorm(1,mean=1,sd=1)
}
else{x[i]=rnorm(1,mean=2,sd=2)}
}
hist(x)
l<-rbinom(1000,1,0.5)
x<-vector(length=1000)
for (i in 1:1000){
if(l[i]==0){
x[i]=rnorm(1,mean=1,sd=1)
}
else{x[i]=rnorm(1,mean=2,sd=2)}
}
hist(x)
l<-rbinom(1000,1,0.5)
x<-vector(length=1000)
for (i in 1:1000){
if(l[i]==0){
x[i]=rnorm(1,mean=1,sd=1)
}
else{x[i]=rnorm(1,mean=2,sd=2)}
}
hist(x)
l<-rbinom(1000,1,0.5)
x<-vector(length=1000)
for (i in 1:1000){
if(l[i]==0){
x[i]=rnorm(1,mean=1,sd=1)
}
else{x[i]=rnorm(1,mean=2,sd=2)}
}
hist(x)
final=mixture(x,method="EM",maxit=1000)
final
l<-rbinom(1000,1,0.5)
x<-vector(length=1000)
for (i in 1:1000){
if(l[i]==0){
x[i]=rnorm(1,mean=1,sd=1)
}
else{x[i]=rnorm(1,mean=2,sd=2)}
}
hist(x)
mixture(x,method="EM",maxit=1000)
l<-rbinom(1000,1,0.5)
x<-vector(length=1000)
for (i in 1:1000){
if(l[i]==0){
x[i]=rnorm(1,mean=1,sd=1)
}
else{x[i]=rnorm(1,mean=2,sd=2)}
}
hist(x)
mixture(x,method="EM",maxit=1000)
l<-rbinom(1000,1,0.5)
x<-vector(length=1000)
for (i in 1:1000){
if(l[i]==0){
x[i]=rnorm(1,mean=1,sd=1)
}
else{x[i]=rnorm(1,mean=2,sd=2)}
}
hist(x)
mixture(x,method="EM",maxit=1000)
l<-rbinom(1000,1,0.5)
x<-vector(length=1000)
for (i in 1:1000){
if(l[i]==0){
x[i]=rnorm(1,mean=1,sd=1)
}
else{x[i]=rnorm(1,mean=2,sd=2)}
}
hist(x)
mixture(x,method="EM",maxit=1000)
l<-rbinom(1000,1,0.5)
x<-vector(length=1000)
for (i in 1:1000){
if(l[i]==0){
x[i]=rnorm(1,mean=1,sd=1)
}
else{x[i]=rnorm(1,mean=2,sd=2)}
}
hist(x)
mixture(x,method="EM",maxit=1000)
l<-rbinom(1000,1,0.5)
x<-vector(length=1000)
for (i in 1:1000){
if(l[i]==0){
x[i]=rnorm(1,mean=1,sd=1)
}
else{x[i]=rnorm(1,mean=2,sd=2)}
}
hist(x)
mixture(x,method="EM",maxit=1000)
l<-rbinom(1000,1,0.5)
x<-vector(length=1000)
for (i in 1:1000){
if(l[i]==0){
x[i]=rnorm(1,mean=1,sd=1)
}
else{x[i]=rnorm(1,mean=2,sd=2)}
}
hist(x)
mixture(x,method="EM",maxit=1000)
l<-rbinom(1000,1,0.5)
x<-vector(length=1000)
for (i in 1:1000){
if(l[i]==0){
x[i]=rnorm(1,mean=1,sd=1)
}
else{x[i]=rnorm(1,mean=2,sd=2)}
}
hist(x)
mixture(x,method="EM",maxit=1000)
l<-rbinom(1000,1,0.5)
x<-vector(length=1000)
for (i in 1:1000){
if(l[i]==0){
x[i]=rnorm(1,mean=1,sd=1)
}
else{x[i]=rnorm(1,mean=2,sd=2)}
}
hist(x)
mixture(x,method="EM",maxit=1000)
l<-rbinom(1000,1,0.5)
x<-vector(length=1000)
for (i in 1:1000){
if(l[i]==0){
x[i]=rnorm(1,mean=1,sd=1)
}
else{x[i]=rnorm(1,mean=2,sd=2)}
}
hist(x)
mixture(x,method="EM",maxit=1000)
l<-rbinom(1000,1,0.5)
x<-vector(length=1000)
for (i in 1:1000){
if(l[i]==0){
x[i]=rnorm(1,mean=1,sd=1)
}
else{x[i]=rnorm(1,mean=2,sd=2)}
}
hist(x)
mixture(x,method="EM",maxit=1000)
l<-rbinom(1000,1,0.5)
x<-vector(length=1000)
for (i in 1:1000){
if(l[i]==0){
x[i]=rnorm(1,mean=1,sd=1)
}
else{x[i]=rnorm(1,mean=2,sd=2)}
}
hist(x)
mixture(x,method="EM",maxit=1000)
mixture <- function(y, method, maxit = NULL, tol = 1e-08, param0 = NULL) {
if (method=="EM"){
m<-length(y)
if (is.null(maxit)==TRUE) {
maxit=500
}
if (is.null(param0)==TRUE){
lambda1=0.4;lambda2=0.6;mu1=10;sigma1=3;mu2=20;sigma2=2
}
T<-matrix(rep(0,m*2),nrow=m,ncol=2)
for(i in 1:maxit){
## E
f1=dnorm(y,mean=mu1,sd=sigma1);f2=dnorm(y,mean=mu2,sd=sigma2)
T[,1]=lambda1*f1/((lambda1*f1)+(lambda2*f2))
T[,2]=lambda2*f2/((lambda1*f1)+(lambda2*f2))
## M
lambda1=mean(T[,1]);
lambda2=mean(T[,2])
mu1=sum(T[1:m,1]*y[1:m])/sum(T[1:m,1]);mu2=sum(T[1:m,2]*y[1:m])/sum(T[1:m,2])
sigma1=sum(T[1:m,1]*(y[1:m]-mu1)^2)/sum(T[1:m,1]);sigma2=sum(T[1:m,2]*(y[1:m]-mu2)^2)/sum(T[1:m,2])
##return
}
}
list(lambda=c(lambda1,lambda2),mu1=mu1,mu2=mu2,sigma1=sigma1,sigma2=sigma2)
}
mixture(t,method="EM",maxit=500)
mixture <- function(y, method, maxit = NULL, tol = 1e-08, param0 = NULL) {
if (method=="EM"){
m<-length(y)
if (is.null(maxit)==TRUE) {
maxit=500
}
if (is.null(param0)==TRUE){
lambda1=0.4;lambda2=0.6;mu1=10;sigma1=3;mu2=20;sigma2=2
}
T<-matrix(rep(0,m*2),nrow=m,ncol=2)
for(i in 1:maxit){
## E
f1=dnorm(y,mean=mu1,sd=sigma1);f2=dnorm(y,mean=mu2,sd=sigma2)
T[,1]=lambda1*f1/((lambda1*f1)+(lambda2*f2))
T[,2]=lambda2*f2/((lambda1*f1)+(lambda2*f2))
## M
lambda1=mean(T[,1]);
lambda2=mean(T[,2])
mu1=sum(T[1:m,1]*y[1:m])/sum(T[1:m,1]);mu2=sum(T[1:m,2]*y[1:m])/sum(T[1:m,2])
sigma1=sum(T[1:m,1]*(y[1:m]-mu1)^2)/sum(T[1:m,1]*y[1:m]);sigma2=sum(T[1:m,2]*(y[1:m]-mu2)^2)/sum(T[1:m,2]*y[1:m])
##return
}
}
list(lambda=c(lambda1,lambda2),mu1=mu1,mu2=mu2,sigma1=sigma1,sigma2=sigma2)
}
mixture(t,method="EM",maxit=500)
mixture <- function(y, method, maxit = NULL, tol = 1e-08, param0 = NULL) {
if (method=="EM"){
m<-length(y)
if (is.null(maxit)==TRUE) {
maxit=500
}
if (is.null(param0)==TRUE){
lambda1=0.3;lambda2=0.7;mu1=10;sigma1=3;mu2=20;sigma2=2
}
T<-matrix(rep(0,m*2),nrow=m,ncol=2)
for(i in 1:maxit){
## E
f1=dnorm(y,mean=mu1,sd=sigma1);f2=dnorm(y,mean=mu2,sd=sigma2)
T[,1]=lambda1*f1/((lambda1*f1)+(lambda2*f2))
T[,2]=lambda2*f2/((lambda1*f1)+(lambda2*f2))
## M
lambda1=mean(T[,1]);
lambda2=mean(T[,2])
mu1=sum(T[1:m,1]*y[1:m])/sum(T[1:m,1]);mu2=sum(T[1:m,2]*y[1:m])/sum(T[1:m,2])
sigma1=sum(T[1:m,1]*(y[1:m]-mu1)^2)/sum(T[1:m,1]*y[1:m]);sigma2=sum(T[1:m,2]*(y[1:m]-mu2)^2)/sum(T[1:m,2]*y[1:m])
##return
}
}
list(lambda=c(lambda1,lambda2),mu1=mu1,mu2=mu2,sigma1=sigma1,sigma2=sigma2)
}
mixture(t,method="EM",maxit=500)
hist(t)
mixture <- function(y, method, maxit = NULL, tol = 1e-08, param0 = NULL) {
if (method=="EM"){
m<-length(y)
if (is.null(maxit)==TRUE) {
maxit=500
}
if (is.null(param0)==TRUE){
lambda1=0.3;lambda2=0.7;mu1=10;sigma1=3;mu2=20;sigma2=2
}
T<-matrix(rep(0,m*2),nrow=m,ncol=2)
for(i in 1:maxit){
## E
f1=dnorm(y,mean=mu1,sd=sigma1);f2=dnorm(y,mean=mu2,sd=sigma2)
T[,1]=lambda1*f1/((lambda1*f1)+(lambda2*f2))
T[,2]=lambda2*f2/((lambda1*f1)+(lambda2*f2))
## M
lambda1=mean(T[,1]);
lambda2=mean(T[,2])
mu1=sum(T[1:m,1]*y[1:m])/sum(T[1:m,1]);mu2=sum(T[1:m,2]*y[1:m])/sum(T[1:m,2])
sigma1=sum(T[1:m,1]*(y[1:m]-mu1)^2)/sum(T[1:m,1]);sigma2=sum(T[1:m,2]*(y[1:m]-mu2)^2)/sum(T[1:m,2])
##return
}
}
list(lambda=c(lambda1,lambda2),mu1=mu1,mu2=mu2,sigma1=sigma1,sigma2=sigma2)
}
mixture(t,method="EM",maxit=500)
mixture(t,method="EM",maxit=2)
mixture(t,method="EM",maxit=20)
sum(x)
mean(x)
?attribute
?gradient
